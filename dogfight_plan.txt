I've created a comprehensive implementation plan based on the three AI reviews and my exploration of the      
  codebase. The plan addresses all three of your objectives:                                                    
                                                                                                                
  Key Findings                                                                                                  
                                                                                                                
  1. Graphics Performance Issues (CONFIRMED):                                                                   
  - Double AA enabled (MSAA 2x + FXAA) causing 15-25% overhead                                                  
  - Extreme camera far plane (90,000 units) creating massive render distance                                    
  - Dual FBM noise calculations in terrain shader                                                               
  - 8,000 trees with no LOD system                                                                              
                                                                                                                
  2. Building Design:                                                                                           
  - Sophisticated procedural system with 13+ types already exists                                               
  - Good MultiMesh batching and LOD system                                                                      
  - Currently uses only vertex colors (no textures)                                                             
  - External asset integration points exist but unused                                                          
                                                                                                                
  3. External Assets (CRITICAL BUG FOUND):                                                                      
  - Key mismatch: fetch_assets.py writes euro_building_mesh but game requests euro_buildings                    
  - Manifest.json is completely empty (all variant arrays are [])                                               
  - use_external_assets flag is false                                                                           
  - No texture loading support (only meshes)                                                                    
                                                                                                                
  Plan Structure                                                                                                
                                                                                                                
  The plan is organized into 5 phases:                                                                          
                                                                                                                
  - Phase 0 (Optional): Debug overlay and quality presets                                                       
  - Phase 1: Immediate performance wins (25-45% FPS gain)                                                       
  - Phase 2: Fix external asset integration                                                                     
  - Phase 3: Add texture support                                                                                
  - Phase 4: Enhanced building design                                                                           
  - Phase 5: Advanced features (occlusion, post-processing)                                                     
                                                                                                                
  Each phase includes specific tasks with:                                                                      
  - Exact files to modify                                                                                       
  - Specific code changes needed                                                                                
  - Expected performance/visual improvements                                                                    
  - Verification steps                                                                                          
                                                                                                                
  The plan also includes a 4-week implementation roadmap prioritizing quick wins first.                         
                                                                                                                
⏺ User approved Claude's plan                                                                                   
  ⎿  Plan saved to: ~/.claude/plans/rustling-hugging-wand.md · /plan to edit                                    
     Implementation Plan: Graphics Performance + Buildings + External Assets                                    
                                                                                                                
     Executive Summary                                                                                          
                                                                                                                
     This plan implements three major improvements to the Neon Dogfight game:                                   
     1. Graphics Performance Optimization - 25-45% FPS improvement                                              
     2. Enhanced Building Design - Better architectural variety and visual quality                              
     3. External Asset Integration - Enable downloaded assets and textures                                      
                                                                                                                
     Based on analysis of three AI reviews and comprehensive codebase exploration, this plan prioritizes        
     quick wins first, then builds toward more ambitious features.                                              
                                                                                                                
     Critical Findings from Exploration                                                                         
                                                                                                                
     Graphics Performance Bottlenecks                                                                           
                                                                                                                
     - ✅ CONFIRMED: Double AA enabled (MSAA 2x + FXAA)                                                         
     - ✅ CONFIRMED: Extreme camera far plane (90,000 units)                                                    
     - Camera near plane too tight (0.05) causing z-fighting                                                    
     - Terrain shader performs dual FBM noise calculations (vertex + fragment)                                  
     - 8,000 tree forest with no LOD system                                                                     
     - LOD update frequencies could be optimized                                                                
                                                                                                                
     Building System                                                                                            
                                                                                                                
     - Sophisticated procedural generator with 13+ building types                                               
     - Three-level LOD system with good MultiMesh batching                                                      
     - Vertex color-based materials (no textures currently)                                                     
     - External asset integration points exist but unused                                                       
                                                                                                                
     External Asset System                                                                                      
                                                                                                                
     - CRITICAL BUG: Key name mismatch between fetch_assets.py and game                                         
       - fetch_assets.py writes: euro_building_mesh (singular + _mesh suffix)                                   
       - game requests: euro_buildings (plural, no suffix)                                                      
       - manifest.json has: euro_buildings (plural) but ALL ARRAYS ARE EMPTY                                    
     - use_external_assets flag is false in manifest                                                            
     - asset_library.gd only loads meshes, NO texture support                                                   
     - fetch_assets.py downloads textures but they're never used                                                
                                                                                                                
     ---                                                                                                        
     Phase 0: Baseline & Guardrails (Optional but Recommended)                                                  
                                                                                                                
     Goal: Measure performance and prevent regressions                                                          
                                                                                                                
     Tasks                                                                                                      
                                                                                                                
     1. Add performance debug overlay to HUD                                                                    
       - Display FPS, draw calls, instances, triangle count                                                     
       - Toggle with F12 key                                                                                    
       - Position: Top-right corner                                                                             
     2. Add quality preset system                                                                               
       - Settings: Low/Medium/High enum                                                                         
       - Apply on boot and when changed via settings                                                            
       - Store in user://neon_dogfight_settings.cfg                                                             
                                                                                                                
     Files to modify:                                                                                           
     - scripts/ui/hud.gd - Add debug panel                                                                      
     - scripts/game/game.gd - Add quality preset enum and settings                                              
     - scripts/game/main.gd - Apply quality preset on initialization                                            
                                                                                                                
     Verification: Toggle quality presets and observe FPS changes in debug overlay                              
                                                                                                                
     ---                                                                                                        
     Phase 1: Immediate Performance Wins (High ROI)                                                             
                                                                                                                
     Goal: 25-45% FPS improvement with minimal visual impact                                                    
                                                                                                                
     Task 1.1: Remove Double Anti-Aliasing                                                                      
                                                                                                                
     Problem: Both MSAA 2x and FXAA are enabled simultaneously (15-25% overhead)                                
                                                                                                                
     Solution: Choose one AA method                                                                             
     - Option A (Recommended): Keep FXAA only (fastest, good quality)                                           
     - Option B: Keep MSAA 2x only (cleaner edges, more cost)                                                   
                                                                                                                
     Files to modify:                                                                                           
     - project.godot                                                                                            
       - Change rendering/anti_aliasing/quality/msaa_3d=2 to 0                                                  
       - Keep rendering/anti_aliasing/quality/use_fxaa=true                                                     
                                                                                                                
     Expected gain: 15-25% FPS improvement                                                                      
                                                                                                                
     Task 1.2: Fix Camera Near/Far Planes                                                                       
                                                                                                                
     Problem: Far plane at 90,000 units renders massive view distance; near plane at 0.05 causes z-fighting     
                                                                                                                
     Solution: Set reasonable values                                                                            
     - Near: 0.1 (was 0.05)                                                                                     
     - Far: 45000.0 (was 90000.0) - still 45km but reduces overhead                                             
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/main.gd line 149                                                                            
       - Change camera.near = 0.05 to camera.near = 0.1                                                         
       - Change camera.far = 90000.0 to camera.far = 45000.0                                                    
                                                                                                                
     Expected gain: 30-40% reduction in depth/shadow overhead                                                   
                                                                                                                
     Task 1.3: Cap Shadow Distance                                                                              
                                                                                                                
     Problem: Shadows render at extreme distances where they're not visible                                     
                                                                                                                
     Solution: Limit directional shadow distance to gameplay-relevant range (5-10km)                            
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/main.gd (sun DirectionalLight3D creation around line 164)                                   
       - Add: sun.directional_shadow_max_distance = 8000.0                                                      
       - Add: sun.shadow_bias = 0.02 (reduce peter-panning)                                                     
                                                                                                                
     Expected gain: 10-15% shadow rendering cost reduction                                                      
                                                                                                                
     Task 1.4: Optimize Terrain Shader                                                                          
                                                                                                                
     Problem: Fragment shader runs FBM twice per pixel (line 44 vertex, line 94 fragment "town speckle")        
                                                                                                                
     Solution: Remove second FBM call and use simpler pseudo-random for town speckle                            
                                                                                                                
     Files to modify:                                                                                           
     - resources/shaders/terrain_ww2.gdshader                                                                   
       - Line 94: Replace float town = fbm(p * 0.01 + vec2(4.2, 1.7)); with simple hash:                        
       vec2 town_p = floor(p * 0.01);                                                                           
     float town = fract(sin(dot(town_p, vec2(12.9898, 78.233))) * 43758.5453);                                  
       - (Optional) Reduce FBM octaves from 4 to 3 in the fbm() function (line 44-55)                           
                                                                                                                
     Expected gain: 25-30% fragment shader time reduction                                                       
                                                                                                                
     Task 1.5: Reduce Forest Complexity                                                                         
                                                                                                                
     Problem: 8,000 trees with no LOD or culling                                                                
                                                                                                                
     Solution: Reduce default tree count and add basic LOD                                                      
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/game.gd                                                                                     
       - Change default forest_trees from 8000 to 5000                                                          
     - scripts/game/main.gd (forest generation around line 2493)                                                
       - Add distance-based tree density (cull trees beyond 12km)                                               
                                                                                                                
     Expected gain: 30% geometry reduction                                                                      
                                                                                                                
     Phase 1 Total Expected Improvement: 25-45% FPS gain (hardware dependent)                                   
                                                                                                                
     ---                                                                                                        
     Phase 2: Fix External Asset Integration (Unlock Visual Quality)                                            
                                                                                                                
     Goal: Make external assets actually appear in the game                                                     
                                                                                                                
     Task 2.1: Fix fetch_assets.py Key Mismatch                                                                 
                                                                                                                
     Problem: Script writes wrong key names to manifest                                                         
                                                                                                                
     Current output:                                                                                            
     "variants": {                                                                                              
       "euro_building_mesh": [...],                                                                             
       "beach_shack_mesh": [...],                                                                               
       "tree_mesh": [...]                                                                                       
     }                                                                                                          
                                                                                                                
     Required output:                                                                                           
     "variants": {                                                                                              
       "euro_buildings": [...],                                                                                 
       "industrial_buildings": [...],                                                                           
       "beach_shacks": [...],                                                                                   
       "trees_conifer": [...],                                                                                  
       "trees_broadleaf": [...],                                                                                
       "trees_palm": [...]                                                                                      
     }                                                                                                          
                                                                                                                
     Solution: Update build_variant_pools() function in fetch_assets.py                                         
                                                                                                                
     Files to modify:                                                                                           
     - tools/fetch_assets.py (around line 200-300 in build_variant_pools())                                     
       - Change return dict keys to match game expectations:                                                    
       return {                                                                                                 
         "euro_buildings": euro_candidates[:24],                                                                
         "industrial_buildings": industrial_candidates[:24],                                                    
         "beach_shacks": shack_candidates[:24],                                                                 
         "trees_conifer": conifer_candidates[:32],                                                              
         "trees_broadleaf": broadleaf_candidates[:32],                                                          
         "trees_palm": palm_candidates[:32],                                                                    
     }                                                                                                          
       - Update filtering logic to categorize Kenney meshes appropriately                                       
       - Add tree type classification (conifer vs broadleaf vs palm)                                            
                                                                                                                
     Verification: Run python3 tools/fetch_assets.py --local-only and inspect generated manifest.json           
                                                                                                                
     Task 2.2: Download and Populate External Assets                                                            
                                                                                                                
     Problem: Manifest variant arrays are empty                                                                 
                                                                                                                
     Solution: Run fetch_assets.py with appropriate flags                                                       
                                                                                                                
     Command:                                                                                                   
     cd /Users/cfaigle/Documents/Development/local/dogfight                                                     
     python3 tools/fetch_assets.py --ww2-assets --polyhaven                                                     
                                                                                                                
     This downloads:                                                                                            
     - Kenney base packs: building-kit, city-suburban, city-industrial, nature-kit                              
     - Kenney WW2 packs: ww2, tanks, military-pack                                                              
     - Poly Haven: hangar, warehouse, factory models                                                            
     - Generates assets/external/manifest.json with populated variant arrays                                    
                                                                                                                
     Files created/modified:                                                                                    
     - assets/external/manifest.json (auto-generated)                                                           
     - assets/external/packs/ (downloaded .glb/.gltf files)                                                     
                                                                                                                
     Verification: Check manifest.json has non-empty arrays for all variant keys                                
                                                                                                                
     Task 2.3: Enable External Assets in Game                                                                   
                                                                                                                
     Problem: use_external_assets flag is false                                                                 
                                                                                                                
     Solution: Either manually edit or add setting toggle                                                       
                                                                                                                
     Option A - Manual:                                                                                         
     - Edit assets/external/manifest.json                                                                       
     - Set "use_external_assets": true                                                                          
                                                                                                                
     Option B - In-game setting (better):                                                                       
     - Add to Game.gd settings dict: use_external_assets = true                                                 
     - Add UI toggle in HUD or settings menu                                                                    
     - Reload world when changed                                                                                
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/game.gd - Add setting                                                                       
     - (Optional) scripts/ui/hud.gd - Add toggle UI                                                             
                                                                                                                
     Verification: Start game, buildings should use external meshes instead of procedural                       
                                                                                                                
     Task 2.4: Connect Industrial Buildings                                                                     
                                                                                                                
     Problem: Industrial areas don't try to use external assets                                                 
                                                                                                                
     Solution: Add external asset support to industrial generation                                              
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/main.gd (around line 1145-1156 where euro_buildings are handled)                            
       - Add similar logic for industrial style:                                                                
       if style == "city":                                                                                      
         ext_key = "euro_buildings"                                                                             
     elif style == "industrial":                                                                                
         ext_key = "industrial_buildings"                                                                       
                                                                                                                
     Verification: Industrial areas show varied building meshes                                                 
                                                                                                                
     Task 2.5: Connect Trees (Optional)                                                                         
                                                                                                                
     Problem: Forest uses only procedural trees                                                                 
                                                                                                                
     Solution: Add external tree mesh support with type selection                                               
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/main.gd (forest generation around line 2493)                                                
       - Query _assets.get_mesh_variants("trees_conifer") and trees_broadleaf                                   
       - If available, randomly mix external + procedural trees                                                 
       - Use biome logic: conifer in mountains, broadleaf in temperate, palm near coast                         
                                                                                                                
     Verification: Forests show mixed tree types from external assets                                           
                                                                                                                
     ---                                                                                                        
     Phase 3: External Texture Integration (Visual Quality Upgrade)                                             
                                                                                                                
     Goal: Use downloaded textures without killing batching performance                                         
                                                                                                                
     Task 3.1: Add Texture Loading to AssetLibrary                                                              
                                                                                                                
     Problem: asset_library.gd only loads meshes, no texture support                                            
                                                                                                                
     Solution: Extend manifest schema and loader                                                                
                                                                                                                
     New manifest structure:                                                                                    
     {                                                                                                          
       "use_external_assets": true,                                                                             
       "variants": { ... },                                                                                     
       "textures": {                                                                                            
         "building_atlas_euro": {                                                                               
           "albedo": "res://assets/external/textures/brick_001_albedo.png",                                     
           "normal": "res://assets/external/textures/brick_001_normal.png",                                     
           "orm": "res://assets/external/textures/brick_001_orm.png"                                            
         },                                                                                                     
         "building_atlas_industrial": {                                                                         
           "albedo": "res://assets/external/textures/metal_001_albedo.png",                                     
           "normal": "res://assets/external/textures/metal_001_normal.png",                                     
           "orm": "res://assets/external/textures/metal_001_orm.png"                                            
         },                                                                                                     
         "terrain_grass": {                                                                                     
           "albedo": "res://assets/external/textures/grass_001_albedo.png",                                     
           "normal": "res://assets/external/textures/grass_001_normal.png"                                      
         }                                                                                                      
       }                                                                                                        
     }                                                                                                          
                                                                                                                
     Files to modify:                                                                                           
     - scripts/util/asset_library.gd                                                                            
       - Add _loaded_textures: Dictionary = {}                                                                  
       - Add func _load_external_textures() - called in reload()                                                
       - Add func get_texture_set(key: String) -> Dictionary - returns {albedo, normal, orm}                    
                                                                                                                
     Files to modify (part 2):                                                                                  
     - tools/fetch_assets.py                                                                                    
       - Update write_manifest() to include "textures" section                                                  
       - Map downloaded ambientCG textures to logical keys                                                      
       - Support albedo/normal/roughness/metallic/ORM formats                                                   
                                                                                                                
     Verification: asset_library.gd can load texture sets by key                                                
                                                                                                                
     Task 3.2: Create Atlased Materials for Buildings                                                           
                                                                                                                
     Problem: Current vertex color system doesn't use textures                                                  
                                                                                                                
     Solution: Create 1-2 shared StandardMaterial3D with texture atlases                                        
                                                                                                                
     Strategy:                                                                                                  
     - Material 1: "building_euro" - brick/plaster/roof tiles                                                   
     - Material 2: "building_industrial" - metal/concrete                                                       
                                                                                                                
     Use vertex colors for variation (tint, age, weathering) while keeping same material instance               
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/main.gd (building material creation around line 904-934)                                    
       - Create shared materials on initialization                                                              
       - Load textures from AssetLibrary                                                                        
       - Apply to MultiMesh instances                                                                           
       - Keep vertex colors for tinting/variation                                                               
                                                                                                                
     Note: This is the most complex task - requires understanding UV mapping and material batching              
                                                                                                                
     Verification: Buildings have texture detail but draw calls remain low                                      
                                                                                                                
     Task 3.3: Add Terrain Texture Blending (Optional High-Impact)                                              
                                                                                                                
     Problem: Terrain uses purely procedural colors                                                             
                                                                                                                
     Solution: Blend textures by slope/height while keeping procedural overlay                                  
                                                                                                                
     Files to modify:                                                                                           
     - resources/shaders/terrain_ww2.gdshader                                                                   
       - Add texture uniforms: uniform sampler2D grass_tex, rock_tex, sand_tex                                  
       - Add normal map support                                                                                 
       - Blend by slope (rock on steep) and height (sand at sea level, grass mid, rock high)                    
       - Keep procedural field grid as subtle macro overlay                                                     
                                                                                                                
     Expected impact: Massive visual quality improvement, minimal performance cost (texture lookups are         
     fast)                                                                                                      
                                                                                                                
     Verification: Terrain has realistic grass/rock/sand textures with smooth blending                          
                                                                                                                
     ---                                                                                                        
     Phase 4: Enhanced Building Design (Quality & Variety)                                                      
                                                                                                                
     Goal: "Much better designed buildings and features"                                                        
                                                                                                                
     Task 4.1: Implement BuildingKit System                                                                     
                                                                                                                
     Problem: Current system mixes procedural and external without clear structure                              
                                                                                                                
     Solution: Create BuildingKit concept for organized architecture                                            
                                                                                                                
     New structure:                                                                                             
     class BuildingKit:                                                                                         
         var base_meshes: Array[Mesh] = []                                                                      
         var roof_meshes: Array[Mesh] = []                                                                      
         var detail_meshes: Array[Mesh] = [] # chimneys, balconies, etc                                         
         var material: Material                                                                                 
         var style: String # "euro", "industrial", "coastal", "rural"                                           
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/main.gd                                                                                     
       - Create BuildingKit class or struct                                                                     
       - Pre-build kits on initialization (one per settlement style)                                            
       - Each settlement type picks its kit                                                                     
       - Mix procedural + external meshes within kit                                                            
                                                                                                                
     Benefit: Clear separation of styles, easier to extend, better organization                                 
                                                                                                                
     Task 4.2: Add Silhouette Variety                                                                           
                                                                                                                
     Problem: Most buildings are simple rectangles                                                              
                                                                                                                
     Solution: Add varied footprints and massing                                                                
                                                                                                                
     New building features:                                                                                     
     - Footprints: L-shaped, T-shaped, U-shaped (not just rectangles)                                           
     - Step-backs: 2-3 stacked volumes with decreasing size (skyscraper style)                                  
     - Roof families: Gable, hip, mansard, flat, sawtooth (industrial), gambrel                                 
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/main.gd (procedural building generation)                                                    
       - Add footprint generation functions                                                                     
       - Add step-back logic for tall buildings                                                                 
       - Expand roof mesh generation                                                                            
                                                                                                                
     Note: Can be done procedurally using existing ProcMesh utilities                                           
                                                                                                                
     Verification: Buildings have varied shapes beyond simple boxes                                             
                                                                                                                
     Task 4.3: Add Architectural Details                                                                        
                                                                                                                
     Problem: Buildings lack visual interest at close range                                                     
                                                                                                                
     Solution: Add period-appropriate WW2-era details                                                           
                                                                                                                
     New details:                                                                                               
     - Windows: Grid patterns, shutters, blackout curtains                                                      
     - Doors: Recessed entries, stoops                                                                          
     - Trim: Cornices, window frames, base molding                                                              
     - Damage: Bullet holes, cracked walls, missing roof tiles (weathering)                                     
     - Period elements: Air raid sirens, sandbags, camouflage netting                                           
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/main.gd                                                                                     
       - Add detail mesh generation to procedural buildings                                                     
       - Add weathering/damage variation parameter                                                              
       - Use settlement age parameter to control detail density                                                 
                                                                                                                
     LOD consideration: Only add details to LOD0, skip for LOD1/LOD2                                            
                                                                                                                
     Verification: Close-up buildings show windows, doors, architectural trim                                   
                                                                                                                
     Task 4.4: Implement Feature Clusters                                                                       
                                                                                                                
     Problem: Props are scattered randomly, world feels disconnected                                            
                                                                                                                
     Solution: Group related features into designed "places"                                                    
                                                                                                                
     Cluster types:                                                                                             
     - Farm: Barn + silo + fences + tractor + field boundary                                                    
     - Industrial yard: Warehouse + storage tanks + pipes + loading dock + rail                                 
     - Coastal dock: Shacks + pier + boats + fishing nets + crates                                              
     - Military installation: Bunker + watchtower + vehicle depot + sandbag walls                               
     - City plaza: Fountain + benches + statue + surrounding buildings                                          
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/main.gd                                                                                     
       - Create cluster generation functions                                                                    
       - Replace some random prop placement with cluster placement                                              
       - Use settlement seed for cluster positioning                                                            
                                                                                                                
     Verification: World feels designed with intentional "places" instead of random scatter                     
                                                                                                                
     ---                                                                                                        
     Phase 5: Advanced Features (Polish)                                                                        
                                                                                                                
     Goal: Next-level visual quality and performance tuning                                                     
                                                                                                                
     Task 5.1: Implement Occlusion Culling                                                                      
                                                                                                                
     Problem: All settlements render regardless of visibility                                                   
                                                                                                                
     Solution: Use Godot's OccluderInstance3D or manual frustum culling                                         
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/main.gd                                                                                     
       - Add frustum culling for terrain chunks (check AABB vs camera frustum)                                  
       - Add settlement visibility based on camera position                                                     
       - Update every 0.25s (same as LOD updates)                                                               
                                                                                                                
     Expected gain: 10-20% in complex scenes with many settlements                                              
                                                                                                                
     Task 5.2: Dynamic Resolution Scaling                                                                       
                                                                                                                
     Problem: Performance drops in complex scenes                                                               
                                                                                                                
     Solution: Automatically reduce render resolution when FPS drops                                            
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/main.gd or new performance_manager.gd                                                       
       - Monitor FPS every frame                                                                                
       - If FPS < 45: set get_viewport().scaling_3d_scale = 0.9                                                 
       - If FPS < 30: set to 0.8                                                                                
       - If FPS > 60: restore to 1.0                                                                            
       - Add hysteresis to prevent flickering                                                                   
                                                                                                                
     Verification: FPS stays above 45 by reducing resolution when needed                                        
                                                                                                                
     Task 5.3: Post-Processing Stack (Optional)                                                                 
                                                                                                                
     Problem: Game looks flat without post-processing                                                           
                                                                                                                
     Solution: Add subtle post-effects                                                                          
                                                                                                                
     Effects to add:                                                                                            
     - Bloom: Glow on explosions, sun, muzzle flashes                                                           
     - Tonemapping: Already ACES, confirm it's working                                                          
     - Color grading: Slight desaturation for WW2 film look                                                     
     - Depth of field: Blur distant objects slightly (very subtle)                                              
                                                                                                                
     Files to modify:                                                                                           
     - scripts/game/main.gd                                                                                     
       - Add Environment resource configuration                                                                 
       - Enable bloom with low threshold                                                                        
       - Add color correction LUT (optional)                                                                    
                                                                                                                
     Note: Post-processing has cost - only enable on High quality preset                                        
                                                                                                                
     Verification: Explosions bloom, overall image has cinematic quality                                        
                                                                                                                
     ---                                                                                                        
     Implementation Priority                                                                                    
                                                                                                                
     If implementing incrementally, follow this order for maximum impact:                                       
                                                                                                                
     Week 1: Critical Fixes (Phase 1 + Phase 2.1-2.3)                                                           
                                                                                                                
     1. Remove double AA (Task 1.1)                                                                             
     2. Fix camera near/far (Task 1.2)                                                                          
     3. Cap shadow distance (Task 1.3)                                                                          
     4. Optimize terrain shader (Task 1.4)                                                                      
     5. Fix fetch_assets.py keys (Task 2.1)                                                                     
     6. Download external assets (Task 2.2)                                                                     
     7. Enable external assets (Task 2.3)                                                                       
                                                                                                                
     Expected result: 25-45% FPS improvement + external buildings visible                                       
                                                                                                                
     Week 2: Asset Integration (Phase 2.4-2.5 + Phase 3.1-3.2)                                                  
                                                                                                                
     8. Connect industrial buildings (Task 2.4)                                                                 
     9. Connect trees (Task 2.5)                                                                                
     10. Add texture loading (Task 3.1)                                                                         
     11. Create atlased materials (Task 3.2)                                                                    
                                                                                                                
     Expected result: All external assets working + textured buildings                                          
                                                                                                                
     Week 3: Visual Quality (Phase 3.3 + Phase 4.1-4.3)                                                         
                                                                                                                
     12. Terrain texture blending (Task 3.3)                                                                    
     13. BuildingKit system (Task 4.1)                                                                          
     14. Silhouette variety (Task 4.2)                                                                          
     15. Architectural details (Task 4.3)                                                                       
                                                                                                                
     Expected result: Significantly improved visual quality                                                     
                                                                                                                
     Week 4: Polish (Phase 4.4 + Phase 5)                                                                       
                                                                                                                
     16. Feature clusters (Task 4.4)                                                                            
     17. Occlusion culling (Task 5.1)                                                                           
     18. Dynamic resolution (Task 5.2)                                                                          
     19. Post-processing (Task 5.3)                                                                             
                                                                                                                
     Expected result: Production-quality visuals with stable performance                                        
                                                                                                                
     ---                                                                                                        
     Critical Files Reference                                                                                   
     File: project.godot                                                                                        
     Purpose: Engine settings                                                                                   
     Key Changes: Remove double AA                                                                              
     ────────────────────────────────────────                                                                   
     File: scripts/game/main.gd                                                                                 
     Purpose: Main game loop, world gen                                                                         
     Key Changes: Camera, LOD, buildings, external assets                                                       
     ────────────────────────────────────────                                                                   
     File: scripts/game/game.gd                                                                                 
     Purpose: Global settings                                                                                   
     Key Changes: Quality presets, external asset toggle                                                        
     ────────────────────────────────────────                                                                   
     File: scripts/util/asset_library.gd                                                                        
     Purpose: Asset loading                                                                                     
     Key Changes: Add texture support                                                                           
     ────────────────────────────────────────                                                                   
     File: resources/shaders/terrain_ww2.gdshader                                                               
     Purpose: Terrain rendering                                                                                 
     Key Changes: Optimize FBM, add texture blending                                                            
     ────────────────────────────────────────                                                                   
     File: tools/fetch_assets.py                                                                                
     Purpose: Asset downloader                                                                                  
     Key Changes: Fix key names, add texture manifest                                                           
     ────────────────────────────────────────                                                                   
     File: assets/external/manifest.json                                                                        
     Purpose: Asset registry                                                                                    
     Key Changes: Auto-generated by fetch_assets.py                                                             
     ────────────────────────────────────────                                                                   
     File: scripts/ui/hud.gd                                                                                    
     Purpose: HUD display                                                                                       
     Key Changes: Add debug overlay                                                                             
     ---                                                                                                        
     Verification Plan                                                                                          
                                                                                                                
     Performance Testing                                                                                        
                                                                                                                
     1. Baseline measurement (before changes):                                                                  
       - Run game with F12 debug overlay                                                                        
       - Record FPS, draw calls, triangle count                                                                 
       - Take screenshot for visual comparison                                                                  
     2. After Phase 1 (performance optimizations):                                                              
       - Measure FPS improvement (target: +25-45%)                                                              
       - Verify visual quality is acceptable                                                                    
       - Check shadow distance is appropriate                                                                   
     3. After Phase 2 (external assets):                                                                        
       - Verify buildings use external meshes                                                                   
       - Count unique building types visible                                                                    
       - Confirm no performance regression                                                                      
     4. After Phase 3 (textures):                                                                               
       - Verify textures load correctly                                                                         
       - Check draw call count (should stay low)                                                                
       - Confirm visual quality improvement                                                                     
     5. After Phase 4 (building design):                                                                        
       - Verify architectural variety                                                                           
       - Check building clusters appear correctly                                                               
       - Confirm LOD transitions are smooth                                                                     
                                                                                                                
     Functional Testing                                                                                         
                                                                                                                
     - F2/F3: Regenerate world and verify consistency                                                           
     - F4: Toggle peaceful mode                                                                                 
     - F12: Toggle debug overlay                                                                                
     - Tab through settlements: Verify LOD transitions                                                          
     - Fly near buildings: Check texture detail and architectural features                                      
     - Toggle external assets: Verify fallback to procedural works                                              
                                                                                                                
     Asset Pipeline Testing                                                                                     
                                                                                                                
     1. Run: python3 tools/fetch_assets.py --local-only                                                         
     2. Verify manifest.json has correct keys                                                                   
     3. Run: /Applications/Godot.app/Contents/MacOS/Godot --import --headless --verbose                         
     4. Verify assets import without errors                                                                     
     5. Launch game and check external assets appear                                                            
                                                                                                                
     ---                                                                                                        
     Success Metrics                                                                                            
     ┌──────────────────────┬─────────────────┬─────────────────────┬──────────────────────────────────────┐    
     │        Metric        │    Baseline     │       Target        │            How to Measure            │    
     ├──────────────────────┼─────────────────┼─────────────────────┼──────────────────────────────────────┤    
     │ FPS                  │ ~45-60          │ 60+ stable          │ F12 debug overlay                    │    
     ├──────────────────────┼─────────────────┼─────────────────────┼──────────────────────────────────────┤    
     │ Draw Calls           │ ~500-800        │ <600                │ F12 debug overlay                    │    
     ├──────────────────────┼─────────────────┼─────────────────────┼──────────────────────────────────────┤    
     │ Building Variety     │ 13 types        │ 30+ types           │ Visual inspection                    │    
     ├──────────────────────┼─────────────────┼─────────────────────┼──────────────────────────────────────┤    
     │ Texture Coverage     │ 0%              │ 80%+                │ Count textured vs untextured objects │    
     ├──────────────────────┼─────────────────┼─────────────────────┼──────────────────────────────────────┤    
     │ External Asset Usage │ 0%              │ 80%+                │ Check manifest vs visible objects    │    
     ├──────────────────────┼─────────────────┼─────────────────────┼──────────────────────────────────────┤    
     │ Visual Quality       │ Procedural only │ Textured + detailed │ Screenshot comparison                │    
     └──────────────────────┴─────────────────┴─────────────────────┴──────────────────────────────────────┘    
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                
                                                                                                                
     ---                                                                                                        
     Risk Mitigation                                                                                            
                                                                                                                
     Performance Regression                                                                                     
                                                                                                                
     - Risk: Texture loading or complex buildings reduce FPS                                                    
     - Mitigation: Implement Phase 0 debug overlay first, measure at each phase                                 
     - Rollback: Keep quality presets to disable expensive features                                             
                                                                                                                
     Asset Pipeline Failures                                                                                    
                                                                                                                
     - Risk: fetch_assets.py fails or downloads broken files                                                    
     - Mitigation: Test with --local-only flag first, use known-good assets                                     
     - Rollback: Game already has fallback to procedural generation                                             
                                                                                                                
     Visual Inconsistency                                                                                       
                                                                                                                
     - Risk: External + procedural buildings don't match stylistically                                          
     - Mitigation: Implement BuildingKit system (Phase 4.1) to unify styles                                     
     - Rollback: Can disable external assets via manifest flag                                                  
                                                                                                                
     Godot Import Issues                                                                                        
                                                                                                                
     - Risk: External .glb/.gltf files don't import correctly                                                   
     - Mitigation: Use /Applications/Godot.app/Contents/MacOS/Godot --import --verbose --check-only to          
     validate                                                                                                   
     - Rollback: asset_library.gd already handles missing files gracefully                                      
                                                                                                                
     ---                                                                                                        
     Notes for Implementation                                                                                   
                                                                                                                
     1. Test incrementally: After each task, run the game and verify functionality                              
     2. Commit frequently: Use git to checkpoint progress after each phase                                      
     3. Backup manifest: Keep copy of working manifest.json before regenerating                                 
     4. Use verbose mode: When debugging, use --verbose flag for Godot CLI                                      
     5. Monitor performance: Keep F12 debug overlay visible during development                                  
     6. Document changes: Update CLAUDE.md after major changes to architecture   